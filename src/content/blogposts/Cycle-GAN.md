---
title: Application of CycleGAN to PWS birtmarks removal
description: A research project which utilizes cycleGAN architecture to translate between images of (A) healthy faces and (B) faces affected by PWS (Port Wine Stain Birtmark) and vice-versa
date: 2024-05-01
tags: ["AI applications", "GANs", "cycleGAN", "PyTorch"]
technologies: "PyTorch, Python"
GHlink: https://github.com/szczekulskij/cycleGAN-pws/
---

## Background - PWS birtmarks
Port-Wine Stains (PWS) are birthmarks caused by capillary malformations, appearing as persistent red or purple skin discolorations. PWS are usually present at birth and can occur anywhere on the body, but most commonly on the face, which is the focus of our data.


![PWS face](data:image/jpeg;base64,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)

Treatment for PWS birthmarks often requires multiple laser sessions for cosmetic reduction, with improvement typically around ~60% as measured by the % GCE metric. This can vary depending on factors such as age and gender. Example result of treatment can be seen below (pre/post photo)

![PWS pre/post treatment](data:image/jpeg;base64,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)

## Background - GANs
Generative Adversarial Networks (GANs) are a class of generative AI models used primarily for image generation and synthesis. They have been a significant part of AI advancements for image-related tasks.

## Background - CycleGAN
A specific variant of GANs, known as CycleGAN, is employed for image translation tasks. The translation task involves the conversion back and forth between two different image forms (eg. images distribution). For instance, it can be used for converting between ordinary photographs and monet’s artworks as can be seen on the picture below. For cycleGAN we don't require paired images, since we learn how translate between 2 underlying distributions.

## Background - cGAN
A specific variant of GANs, known as cGAN, is employed for image translation tasks. 


## Problem statements
PWB treatment can be expensive, and the treatment results can vary from person to person depending on multitude of factors described previously. Therefore we'd like to (1) show our patients how their face would look like with PWB removed and (2) accurately predict patient's look post-operation.

## Problem 1 solution - Showing patient how their face would look like with PWB fully removed

![Solution 1](https://i.ibb.co/NF2txqQ/cycle-GAN-pws.png)

### Data gathering
To train cycleGAN for this use-case, we require (1) photos of "healthy" faces without PWB and (2) photos of PWB faces. To gather as much data as possible, we've scraped internet using python and serpapi for (2). For (1) we've utilized already existing dataset of human faces.

### Training cycleGAN
The cycleGAN's architecture follows that of the original paper (https://arxiv.org/pdf/1703.10593) with few caveats listed below. The exact hyperparameters of our cycleGAN's nets can be found in the code linked at the bottom of the page. Training took approximately 3 days at Kaggle's free TPU.

Main differences with the original cycleGAN paper:
* Rather than using patchGAN (eg. discrimnator classifing whether 70 × 70 overlapping image patches are real or fake), we've used a disciminator that looks at the entire image. This was required since disciminator needs to be able to look at the entire face at once.
* To counteract network overfitting due to limited amount of data, we've used data augmentation. Since applying non-differentiable data augmentation results in shift of underlying distribution, we've applied differentiable data augmentations.


## Problem 2 solution - Showing patient how their face would look post treatment
![solution 2 img](https://i.ibb.co/qkfZGBs/Screenshot-2024-07-07-at-19-27-44.png)
For this task we need to train a cGAN on paired images of (1) patient pre-treatment; (2) patient post-treatment. However there is not enough photos available online or at any single clinic, therefore we're currentely unable to implement and test this solution.



## Final notes
* All the code can be found in the github repo, link included at the bottom of this blog post. 
* For this project we've utilized Kaggle's free TPU. Although it's a great resource, it's still quite limited which resulted in a need for downsizing nr of parameters in our models. In the future we're planning to extend this project by using higher quality resources.
* It'd be interesting to use VITs rather than CNNs for discriminator implementations, since VITs should be able to zoom/focus onto the PWB easier.
* In my opinion, the main bottleneck in extending this research is limited amount of data. As medicine becomes more modarnized and accessible (eg. clinics putting their resources such as photos together), models like the one introduced above will become more and more powerful. Furthermore, doors to new project ideas will open up.

